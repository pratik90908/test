import pytest
from luna.exploits import fetch_exploits

@pytest.mark.asyncio
async def test_fetch_exploits(httpx_mock):
    expected = [{"id": "EXP-0001"}]
    httpx_mock.add_response(json={"data": {"search": expected}})
    results = await fetch_exploits("CVE-0000")
    assert results == expected
