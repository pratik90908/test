"""Utilities for retrieving exploit information."""

from __future__ import annotations

from typing import Dict, List

import httpx


async def fetch_exploits(cve_id: str) -> List[Dict]:
    """Return exploits related to a given CVE via the Vulners API."""
    url = "https://vulners.com/api/v3/search/lucene/"
    params = {"query": f"type:exploit cve:{cve_id}"}
    async with httpx.AsyncClient(timeout=10) as client:
        response = await client.get(url, params=params)
        response.raise_for_status()
        data = response.json()
    return data.get("data", {}).get("search", [])

